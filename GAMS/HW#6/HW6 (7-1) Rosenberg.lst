GAMS 51.1.0  2d039df5 Sep 13, 2025          WEX-WEI x86 64bit/MS Windows - 10/20/25 13:55:13 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


      CEE 6410 Fall 2015
      Example 7.1 in the Bishop et al text
       
      Develop a mixed integer programming model for the following reservoir design problem and solve.
       
      A farmer plans to develop water for irrigation.
      He is considering two possible sources of water:
       
         - a gravity diversion from a possible reservoir with two alternative capacities and/or
         - a pump from a lower river diversion (refer to Figure 7.3 in the text).
       
      Between the reservoir and pump site the river base flow increases by 2 acft/day
      due to groundwater drainage into the river.  Ignore losses from the reservoir.
      The river flow into the reservoir and the farmer's demand during each of two six-month seasons
      of the year are given in Table 7.5.  Revenue is esti-mated at $300 per year per acre irrigated.
       
      Table 7.5:  Seasonal Flow and Demand
      Season, t        River Inflow, Qt (acft)        Irrigation Demand (acft/acre)
      1                       600                                 1.0
      2                       200                                 3.0
       
       
      Assume that there are only two possible sizes of reservoir:
      a high dam that has capacity of 700 acft or a low dam with capacity of 300 acft.
      The capital costs are $10,000/year and $6,000/year for the high and low dams,
      respectively (no operating cost).  The pump capac-ity is fixed at 2.2 acft/day
      with a capital cost (if it is built) of $8,000/year and operating cost of $20/acft.
       
      David E Rosenberg
      david.rosenberg@usu.edu
      September 28, 2015
       
  35   
  36  * 1. DEFINE the SETS
  37  SETS src water supply sources /res "diversion from reservoir", pum "pump from river"/
  38       lev   source size /lev0 "none", lev1 "small", lev2 "big"/
  39       t   time in seasons /s1*s2/;
  40   
  41   
  42  * 2. DEFINE the variables
  43  VARIABLES I(src,lev) binary decision to build or do prject from source src(1=yes 0=no)
  44            X(src,t) volume of water provided by source src in time t (ac-ft per season)
  45            REL(t)   Reservoir release to river in time t (ac-ft per season)
  46            STOR(t)     Reservoir storage volume in time t (ac-ft)
  47            AREA     Area irrigated (ac)
  48            TBEN  Total net benefits that are revenus minus capital and operating costs ($);
  49   
  50  BINARY VARIABLES I;
  51  * Non-negativity constraints
  52  POSITIVE VARIABLES X, REL, STOR;
  53   
  54   
  55  * 3. DEFINE input data
  56  TABLE CapCost(src,lev) capital cost ($ to build)
  57             lev1  lev2
  58      res    6000  10000
  59      pum    8000        ;
  60  *leaving out r0 keeps the default entry of zero
  61   
  62  PARAMETER OpCost(src) operating cost ($ per ac-ft)
  63       /res    0,
  64        pum    20/ ;
  65   
  66  TABLE MaxCapacity(src,lev) Maximum capacity of source when built (ac-ft per season)
  67             lev1  lev2
  68      res    300   700;
  69   
  70  *Define the maximum capacity programatically for the pump (covert from daily to seasonal)
  71  * card(t) counts the number of elements in set to MaxCapacity("pum","lev1") = 2.2*365/card(t);
  72   
  73  PARAMETERS RiverInflow(t) River inflow in time t (ac-ft)
  74                   /s1 600, s2 200/
  75             Demand(t) Irrigation demand in time t (ac-ft per acre)
  76                   /s1 1.0, s2 3.0/
  77             InitStor Initial reservoir storage (fraction of full capacity)
  78                  /0/
  79             BaseFlow River baseflow below the reservoir (ac-ft)
  80                  /2/
  81             Revenue  Revenue from irrigation ($ per year per acre)
  82                  /300/;
  83   
  84  *Convert daily baseflow to seasonal baseflow BaseFlow = BaseFlow*365/card(t);
  85   
  86   
  87  * 4. COMBINE variables and data in equations
  88  EQUATIONS
  89     NetBen          Revenues minus capital and operating costs ($) and objective function value
  90     AreaToSupply(t) Area to supply with deliveries (ac)
  91     PumpCapacity(t) Pumping within capacity in each time step (ac-ft per season)
  92     ResCapacity(t)  Reservoir storage within capacity in each time step (ac-ft)
  93     MutExclus(src)  Can only implement one project size (#)
  94     RivMassBal(t)   River mass balance downstream of reservoir in each timestep (ac-ft)
  95     ResMassBal(t)   Reservoir mass balance in each time step (ac-ft);
  96   
  97   
  98  NetBen..                 TBEN =E= Revenue*AREA - SUM(src,SUM(lev,CapCost(src,lev)*I(src,lev)) + SUM(t,OpCost(src)*X(src,t)));
  99  AreaToSupply(t)..        AREA =L= SUM(src,X(src,t))/Demand(t);
 100  PumpCapacity(t)..        X("pum",t) =L= sum(lev,MaxCapacity("pum",lev)*I("pum",lev));
 101  ResCapacity(t)..            STOR(t) =L= sum(lev,MaxCapacity("res",lev)*I("res",lev));
 102  RivMassBal(t)..          X("pum",t) =L= REL(t) + BaseFlow;
 103  MutExclus(src)..         sum(lev,I(src,lev)) =L= 1;
 104   
 105  *Reservoir mass balance
 106  *In first time step, previous storage is the initial storage (a fraction of the capacity).
 107  *In subsequent time steps, prevous storage is the prior storage variable (t-1).
 108  *Differentiate the cases using the $ operator $(ord(t) eq 1) => first timestep
 109  *                                             $(ord(t) gt 1) => subsequenttime steps
 110  ResMassBal(t)..   STOR(t) =E= RiverInflow(t) - REL(t) - X("res",t) +
 111  *                    Initial storage = fraction of reservoir capacity to include for equation for first time step
 112  InitStor*sum(lev,MaxCapacity("res",lev)*I("res",lev))$(ord(t) eq 1)  +
 113  *                    Prior storage to include for equations for subsequenttime steps (t-1)
 114  STOR(t-1)$(ord(t) gt 1);
 115   
 116  * 5. DEFINE the MODEL from the EQUATIONS
 117  MODEL ResDesign /ALL/;
 118   
 119  * 6. Solve the Model as an LP (relaxed IP)
 120  SOLVE ResDesign USING MIP Maximizing TBEN;
 121   
 122  DISPLAY X.L, I.L, TBEN.L;
 123   
 124  * Dump all input data and results to a GAMS gdx file
 125  *Execute_Unload "Ex7-1.gdx";
 126  * Dump the gdx file to an Excel workbook
 127  *Execute "gdx2xls Ex7-1.gdx"


COMPILATION TIME     =        0.000 SECONDS      3 MB  51.1.0 2d039df5 WEX-WEI
GAMS 51.1.0  2d039df5 Sep 13, 2025          WEX-WEI x86 64bit/MS Windows - 10/20/25 13:55:13 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Equation Listing    SOLVE ResDesign Using MIP From line 120


---- NetBen  =E=  Revenues minus capital and operating costs ($) and objective function value

NetBen..  6000*I(res,lev1) + 10000*I(res,lev2) + 8000*I(pum,lev1) + 20*X(pum,s1) + 20*X(pum,s2) - 300*AREA + TBEN =E= 0 ; (LHS = 0)
     

---- AreaToSupply  =L=  Area to supply with deliveries (ac)

AreaToSupply(s1)..  - X(res,s1) - X(pum,s1) + AREA =L= 0 ; (LHS = 0)
     
AreaToSupply(s2)..  - 0.333333333333333*X(res,s2) - 0.333333333333333*X(pum,s2) + AREA =L= 0 ; (LHS = 0)
     

---- PumpCapacity  =L=  Pumping within capacity in each time step (ac-ft per season)

PumpCapacity(s1)..  X(pum,s1) =L= 0 ; (LHS = 0)
     
PumpCapacity(s2)..  X(pum,s2) =L= 0 ; (LHS = 0)
     

---- ResCapacity  =L=  Reservoir storage within capacity in each time step (ac-ft)

ResCapacity(s1)..  - 300*I(res,lev1) - 700*I(res,lev2) + STOR(s1) =L= 0 ; (LHS = 0)
     
ResCapacity(s2)..  - 300*I(res,lev1) - 700*I(res,lev2) + STOR(s2) =L= 0 ; (LHS = 0)
     

---- MutExclus  =L=  Can only implement one project size (#)

MutExclus(res)..  I(res,lev0) + I(res,lev1) + I(res,lev2) =L= 1 ; (LHS = 0)
     
MutExclus(pum)..  I(pum,lev0) + I(pum,lev1) + I(pum,lev2) =L= 1 ; (LHS = 0)
     

---- RivMassBal  =L=  River mass balance downstream of reservoir in each timestep (ac-ft)

RivMassBal(s1)..  X(pum,s1) - REL(s1) =L= 2 ; (LHS = 0)
     
RivMassBal(s2)..  X(pum,s2) - REL(s2) =L= 2 ; (LHS = 0)
     

---- ResMassBal  =E=  Reservoir mass balance in each time step (ac-ft)

ResMassBal(s1)..  X(res,s1) + REL(s1) + STOR(s1) =E= 600 ; (LHS = 0, INFES = 600 ****)
     
ResMassBal(s2)..  X(res,s2) + REL(s2) - STOR(s1) + STOR(s2) =E= 200 ; (LHS = 0, INFES = 200 ****)
     
GAMS 51.1.0  2d039df5 Sep 13, 2025          WEX-WEI x86 64bit/MS Windows - 10/20/25 13:55:13 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Column Listing      SOLVE ResDesign Using MIP From line 120


---- I  binary decision to build or do prject from source src(1=yes 0=no)

I(res,lev0)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
        1       MutExclus(res)

I(res,lev1)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
     6000       NetBen
     -300       ResCapacity(s1)
     -300       ResCapacity(s2)
        1       MutExclus(res)

I(res,lev2)
                (.LO, .L, .UP, .M = 0, 0, 1, 0)
    10000       NetBen
     -700       ResCapacity(s1)
     -700       ResCapacity(s2)
        1       MutExclus(res)

REMAINING 3 ENTRIES SKIPPED

---- X  volume of water provided by source src in time t (ac-ft per season)

X(res,s1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       AreaToSupply(s1)
        1       ResMassBal(s1)

X(res,s2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -0.3333  AreaToSupply(s2)
        1       ResMassBal(s2)

X(pum,s1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       20       NetBen
       -1       AreaToSupply(s1)
        1       PumpCapacity(s1)
        1       RivMassBal(s1)

REMAINING ENTRY SKIPPED

---- REL  Reservoir release to river in time t (ac-ft per season)

REL(s1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       RivMassBal(s1)
        1       ResMassBal(s1)

REL(s2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
       -1       RivMassBal(s2)
        1       ResMassBal(s2)


---- STOR  Reservoir storage volume in time t (ac-ft)

STOR(s1)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       ResCapacity(s1)
        1       ResMassBal(s1)
       -1       ResMassBal(s2)

STOR(s2)
                (.LO, .L, .UP, .M = 0, 0, +INF, 0)
        1       ResCapacity(s2)
        1       ResMassBal(s2)


---- AREA  Area irrigated (ac)

AREA
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
     -300       NetBen
        1       AreaToSupply(s1)
        1       AreaToSupply(s2)


---- TBEN  Total net benefits that are revenus minus capital and operating costs ($)

TBEN
                (.LO, .L, .UP, .M = -INF, 0, +INF, 0)
        1       NetBen

GAMS 51.1.0  2d039df5 Sep 13, 2025          WEX-WEI x86 64bit/MS Windows - 10/20/25 13:55:13 Page 4
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Range Statistics    SOLVE ResDesign Using MIP From line 120


RANGE STATISTICS (ABSOLUTE NON-ZERO FINITE VALUES)

RHS       [min, max] : [ 1.000E+00, 6.000E+02] - Zero values observed as well
Bound     [min, max] : [ 1.000E+00, 1.000E+00] - Zero values observed as well
Matrix    [min, max] : [ 3.333E-01, 1.000E+04]

GAMS 51.1.0  2d039df5 Sep 13, 2025          WEX-WEI x86 64bit/MS Windows - 10/20/25 13:55:13 Page 5
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Model Statistics    SOLVE ResDesign Using MIP From line 120


MODEL STATISTICS

BLOCKS OF EQUATIONS           7     SINGLE EQUATIONS           13
BLOCKS OF VARIABLES           6     SINGLE VARIABLES           16
NON ZERO ELEMENTS            38     DISCRETE VARIABLES          6


GENERATION TIME      =        0.000 SECONDS      4 MB  51.1.0 2d039df5 WEX-WEI
GAMS 51.1.0  2d039df5 Sep 13, 2025          WEX-WEI x86 64bit/MS Windows - 10/20/25 13:55:13 Page 6
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Solution Report     SOLVE ResDesign Using MIP From line 120


               S O L V E      S U M M A R Y

     MODEL   ResDesign           OBJECTIVE  TBEN
     TYPE    MIP                 DIRECTION  MAXIMIZE
     SOLVER  CPLEX               FROM LINE  120

**** SOLVER STATUS     1 Normal Completion
**** MODEL STATUS      1 Optimal
**** OBJECTIVE VALUE            50000.0000

 RESOURCE USAGE, LIMIT          0.015 10000000000.000
 ITERATION COUNT, LIMIT         4    2147483647
*** This solver runs with a community license.
--- GMO setup time: 0.00s
--- GMO memory 0.50 Mb (peak 0.50 Mb)
--- Dictionary memory 0.00 Mb
--- Cplex 22.1.2.0 link memory 0.00 Mb (peak 0.00 Mb)
--- Starting Cplex


--- MIP status (101): integer optimal solution.
--- Cplex Time: 0.01sec (det. 0.07 ticks)

--- Returning a primal only solution to GAMS (marginals all set to NA).
--- Fixing integer variables and solving final LP...


--- Fixed MIP status (1): optimal.
--- Cplex Time: 0.00sec (det. 0.02 ticks)


Proven optimal solution
MIP Solution:        50000.000000    (4 iterations, 0 nodes)
Final Solve:         50000.000000    (4 iterations)

Best possible:       50000.000000
Absolute gap:           -0.000000
Relative gap:           -0.000000


                           LOWER          LEVEL          UPPER         MARGINAL

---- EQU NetBen              .              .              .             1.0000      

  NetBen  Revenues minus capital and operating costs ($) and objective function value

---- EQU AreaToSupply  Area to supply with deliveries (ac)

          LOWER          LEVEL          UPPER         MARGINAL

s1        -INF             .              .            75.0000      
s2        -INF             .              .           225.0000      

---- EQU PumpCapacity  Pumping within capacity in each time step (ac-ft per season)

          LOWER          LEVEL          UPPER         MARGINAL

s1        -INF             .              .            55.0000      
s2        -INF             .              .            55.0000      

---- EQU ResCapacity  Reservoir storage within capacity in each time step (ac-ft)

          LOWER          LEVEL          UPPER         MARGINAL

s1        -INF         -300.0000          .              .          
s2        -INF         -700.0000          .              .          

---- EQU MutExclus  Can only implement one project size (#)

           LOWER          LEVEL          UPPER         MARGINAL

res        -INF            1.0000         1.0000          .          
pum        -INF             .             1.0000          .          

---- EQU RivMassBal  River mass balance downstream of reservoir in each timestep (ac-ft)

          LOWER          LEVEL          UPPER         MARGINAL

s1        -INF             .             2.0000          .          
s2        -INF             .             2.0000          .          

---- EQU ResMassBal  Reservoir mass balance in each time step (ac-ft)

          LOWER          LEVEL          UPPER         MARGINAL

s1       600.0000       600.0000       600.0000        75.0000      
s2       200.0000       200.0000       200.0000        75.0000      

---- VAR I  binary decision to build or do prject from source src(1=yes 0=no)

                LOWER          LEVEL          UPPER         MARGINAL

res.lev0          .              .             1.0000         EPS         
res.lev1          .              .             1.0000     -6000.0000      
res.lev2          .             1.0000         1.0000    -10000.0000      
pum.lev0          .              .             1.0000         EPS         
pum.lev1          .              .             1.0000     -8000.0000      
pum.lev2          .              .             1.0000         EPS         

---- VAR X  volume of water provided by source src in time t (ac-ft per season)

              LOWER          LEVEL          UPPER         MARGINAL

res.s1          .           200.0000        +INF             .          
res.s2          .           600.0000        +INF             .          
pum.s1          .              .            +INF             .          
pum.s2          .              .            +INF             .          

---- VAR REL  Reservoir release to river in time t (ac-ft per season)

          LOWER          LEVEL          UPPER         MARGINAL

s1          .              .            +INF          -75.0000      
s2          .              .            +INF          -75.0000      

---- VAR STOR  Reservoir storage volume in time t (ac-ft)

          LOWER          LEVEL          UPPER         MARGINAL

s1          .           400.0000        +INF             .          
s2          .              .            +INF          -75.0000      

                           LOWER          LEVEL          UPPER         MARGINAL

---- VAR AREA              -INF          200.0000        +INF             .          
---- VAR TBEN              -INF        50000.0000        +INF             .          

  AREA  Area irrigated (ac)
  TBEN  Total net benefits that are revenus minus capital and operating costs ($)


**** REPORT SUMMARY :        0     NONOPT
                             0 INFEASIBLE
                             0  UNBOUNDED
GAMS 51.1.0  2d039df5 Sep 13, 2025          WEX-WEI x86 64bit/MS Windows - 10/20/25 13:55:13 Page 7
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
E x e c u t i o n


----    122 VARIABLE X.L  volume of water provided by source src in time t (ac-ft per season)

             s1          s2

res     200.000     600.000


----    122 VARIABLE I.L  binary decision to build or do prject from source src(1=yes 0=no)

           lev2

res       1.000


----    122 VARIABLE TBEN.L                =    50000.000  Total net benefits that are revenus minus capital and operating costs ($)


EXECUTION TIME       =        0.078 SECONDS      4 MB  51.1.0 2d039df5 WEX-WEI


USER: Course License                                 G250902+0003Ac-GEN
      Utah State University                                     DCE4709
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\bhpar\OneDrive\Documents\School\Fall 2025\System Analysis\CEE-6410-Parker\GAMS\HW#6\HW6 (7-1) Rosenberg.gms
Output     C:\Users\bhpar\OneDrive\Documents\School\Fall 2025\System Analysis\CEE-6410-Parker\GAMS\HW#6\HW6 (7-1) Rosenberg.lst
